Моя главная ошибка была не в синтаксисе, а в том, как я понял сами метрики.

Например, для метрики value_per_material_unit (ценность на единицу материала) я думал, что это просто средняя стоимость одного готового товара.
Поэтому я делил общую ценность на количество товаров. А на самом деле нужно было посчитать, какую ценность мы получаем с каждой единицы потраченного сырья.
То есть делить общую ценность на количество потраченных материалов. Это показывает реальную отдачу от ресурсов, а не просто средний ценник.

Та же ошибка в логике произошла с workshop_utilization_percent. 
Я считал время работы мастерской только в те дни, когда что-то производилось (от первой даты производства до последней). 
Эталон же правильно учитывает весь период с момента назначения первого работника. 
Мой подход игнорировал время на подготовку и долгие простои, которые как раз и снижают эффективность.

Самая большая разница оказалась в расчете корреляции. 
Я пытался посчитать средний навык ремесленников и среднее качество товаров отдельно, а потом как-то их связать. 
Это не работает. Правильно было сначала для каждого отдельного ремесленника найти пару значений: «его средний навык» и «среднее качество его изделий». 
И уже потом, имея набор таких пар для всей мастерской, вычислять между ними корреляцию.